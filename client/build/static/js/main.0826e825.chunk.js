(this["webpackJsonprust-onitama"]=this["webpackJsonprust-onitama"]||[]).push([[0],{55:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),r=n(27),s=n.n(r),o=n(4),c=n(5),l=n(7),u=n(6),p=n(29),j=n(2),m=n(28),d=n.n(m),h=n(0),b=d.a.create({baseURL:"/api/",timeout:1e4,headers:{"Content-Type":"application/json"}}),O=i.a.createContext(),f=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={gameId:null,game:null,selection:{fromPosition:null,targetPosition:null,cardName:null},options:null,selectableOptions:[]},a.mutations={startNewGame:function(){return b.post("/games").then((function(e){a.setState({gameId:e.data}),a.mutations.getGame(e.data),a.mutations.getOptions(e.data)}))},getGame:function(e){return b.get("/games/"+e).then((function(e){a.setState({game:e.data})}))},getOptions:function(e){return b.get("/games/"+e+"/options").then((function(e){a.setState({options:e.data}),a.clearSelection()}))},pickOption:function(e){return b.post("/games/"+a.state.gameId+"/options/"+e).then((function(e){a.mutations.getGame(a.state.gameId),a.mutations.getOptions(a.state.gameId)}))},onCellClick:function(e,t){e&&e.player===a.state.game.current_player?a.setOrKeepSelection(t,null,null):a.setOrKeepSelection(null,t,null)},onCardClick:function(e){a.setOrKeepSelection(null,null,e)}},a}return Object(c.a)(n,[{key:"setOrKeepSelection",value:function(e,t,n){var a={fromPosition:e||this.state.selection.fromPosition,targetPosition:t||this.state.selection.targetPosition,cardName:n||this.state.selection.cardName};this.setSelection(a)}},{key:"setSelection",value:function(e){var t=this.filterSelectionOptions(e);if(t.length>0){if(this.setState({selection:e,selectableOptions:t}),null!==e.fromPosition&&null!==e.targetPosition&&null!==e.cardName&&1===t.length){var n=this.state.options.indexOf(t[0]);this.mutations.pickOption(n)}}else this.clearSelection()}},{key:"clearSelection",value:function(){this.setState({selection:{fromPosition:null,targetPosition:null,cardName:null},selectableOptions:this.state.options})}},{key:"filterSelectionOptions",value:function(e){return this.state.options.filter((function(t){return(null===e.fromPosition||t.from_position.x===e.fromPosition.x&&t.from_position.y===e.fromPosition.y)&&((null===e.targetPosition||t.target_position.x===e.targetPosition.x&&t.target_position.y===e.targetPosition.y)&&(null===e.cardName||t.card.name===e.cardName))}))}},{key:"render",value:function(){return Object(h.jsx)(O.Provider,{value:{state:this.state,mutations:this.mutations},children:this.props.children})}}]),n}(a.Component),x=O.Consumer,y=(n(54),n(55),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getClasses",value:function(){var e=this.context.state.selection.fromPosition;if(e&&e.x===this.props.position.x&&e.y===this.props.position.y)return"cell from-cell";var t=this.context.state.selection.targetPosition;return t&&t.x===this.props.position.x&&t.y===this.props.position.y?"cell target-cell":"cell"}},{key:"getImageSrc",value:function(){return"/img/piece-"+(0===this.props.piece.player?"blue":"red")+"-"+(this.props.piece.is_master?"master":"apprentice")+"-front.png"}},{key:"render",value:function(){var e=this;return Object(h.jsx)(x,{children:function(t){t.state;var n=t.mutations;return Object(h.jsx)("div",{className:e.getClasses(),onClick:function(){return n.onCellClick(e.props.piece,e.props.position)},children:e.props.piece&&Object(h.jsx)("img",{className:"piece",src:e.getImageSrc(),alt:"piece"})})}})}}]),n}(a.Component));y.contextType=O;var g=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getClasses",value:function(){var e="card";return this.context.state.selection.cardName===this.props.name&&(e+=" selected-card"),this.props.mini&&(e+=" mini-card"),e}},{key:"getImageSrc",value:function(){return"/img/card-"+this.props.name.toLowerCase()+".jpg"}},{key:"render",value:function(){var e=this;return Object(h.jsx)(x,{children:function(t){t.state;var n=t.mutations;return Object(h.jsx)("div",{className:"card-container",children:Object(h.jsx)("img",{onClick:function(){return n.onCardClick(e.props.name)},className:e.getClasses(),src:e.getImageSrc(),alt:"card"})})}})}}]),n}(a.Component);g.contextType=O;var v=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getClasses",value:function(){return"0"===this.props.playerIndex?"player-panel":"player-panel opponent-player-panel"}},{key:"render",value:function(){var e=this;return Object(h.jsx)(x,{children:function(t){var n=t.state;return Object(h.jsxs)("div",{className:e.getClasses(),children:[parseInt(e.props.playerIndex)===n.game.current_player?Object(h.jsx)(g,{mini:!0,name:n.game.public_card.name}):Object(h.jsx)("div",{className:"mini-card"}),Object(h.jsxs)("div",{className:"cards",children:[Object(h.jsx)(g,{name:n.game.players[e.props.playerIndex].cards[0].name}),Object(h.jsx)(g,{name:n.game.players[e.props.playerIndex].cards[1].name})]})]})}})}}]),n}(a.Component);v.contextType=O;var C=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getCell",value:function(e,t){var n=5*t+e,a=this.context.state.game.field.pieces[n],i={x:e,y:t};return Object(h.jsx)(y,{position:i,piece:a},n)}},{key:"render",value:function(){var e=this;return Object(h.jsx)(x,{children:function(t){t.state,t.mutations;return Object(h.jsxs)("div",{className:"field-panel",children:[Object(h.jsx)(v,{playerIndex:"1"}),Object(h.jsx)("div",{className:"field",children:Object(h.jsx)("div",{className:"field-rows",children:[4,3,2,1,0].map((function(t){return Object(h.jsx)("div",{className:"field-columns",children:[0,1,2,3,4].map((function(n){return e.getCell(n,t)}))},t)}))})}),Object(h.jsx)(v,{playerIndex:"0"})]})}})}}]),n}(a.Component);C.contextType=O;var k=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(h.jsx)(x,{children:function(e){e.state;var t=e.mutations;return Object(h.jsxs)("div",{className:"dialog",children:[Object(h.jsx)("h1",{children:"Welcome!"}),Object(h.jsx)("p",{children:"This is a simple game called Onitama. I did not invent it, I merely implemented this online version of it as s hobby project."}),Object(h.jsx)("h2",{children:"How to play:"}),Object(h.jsx)("p",{children:"You are given control over a Kung Fu master and his apprentices."}),Object(h.jsx)("p",{children:Object(h.jsx)("b",{children:"Your goal is to either beat the enemy master with any of your pieces OR to reach the top middle square with your own master."})}),Object(h.jsxs)("p",{children:["You move according to the ",Object(h.jsx)("i",{children:"movement cards"})," presented on your player tableau:"]}),Object(h.jsx)("p",{children:Object(h.jsx)("b",{children:"Select one of your pieces, a movement card and a target square. The movement cards allow for different moves, as indicated by grey squares."})}),Object(h.jsx)("p",{children:"The target square must not be occupied by one of your own pieces already. After your turn, you lose the movement card you used but get the one that your opponent had used in his last turn. The five movement cards are randomly selected from sixteen existing ones, each representing a different style of Kung Fu."}),Object(h.jsx)("p",{children:Object(h.jsx)("b",{children:"Enjoy!"})}),Object(h.jsx)("button",{className:"btn",onClick:t.startNewGame,children:"Start New Game"})]})}})}}]),n}(a.Component);k.contextType=O;var N=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(h.jsx)(x,{children:function(e){var t=e.state,n=e.mutations;return Object(h.jsxs)("div",{className:"dialog",children:[Object(h.jsxs)("h1",{children:["You ",0===t.game.current_player?"lost":"won","!"]}),Object(h.jsx)("p",{children:"Why not play another one?"}),Object(h.jsx)("button",{className:"btn",onClick:n.startNewGame,children:"Start New Game"})]})}})}}]),n}(a.Component);N.contextType=O;var S=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(h.jsx)(x,{children:function(e){var t=e.state;e.mutations;return Object(h.jsxs)("div",{children:[null===t.game&&Object(h.jsx)(k,{}),null!==t.game&&t.options&&t.options.length>0&&Object(h.jsx)(C,{}),null!==t.game&&t.options&&0===t.options.length&&Object(h.jsx)(N,{})]})}})}}]),n}(a.Component);S.contextType=O;var I=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(h.jsx)(f,{value:this.state,children:Object(h.jsx)(p.a,{children:Object(h.jsx)("div",{className:"App",children:Object(h.jsxs)(j.d,{children:[Object(h.jsx)(j.b,{path:"/",component:S,exact:!0}),Object(h.jsx)(j.b,{children:Object(h.jsx)(j.a,{to:"/"})})]})})})})}}]),n}(a.Component);s.a.render(Object(h.jsx)(I,{}),document.getElementById("root"))}},[[61,1,2]]]);
//# sourceMappingURL=main.0826e825.chunk.js.map