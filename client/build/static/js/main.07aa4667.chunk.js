(this["webpackJsonprust-onitama"]=this["webpackJsonprust-onitama"]||[]).push([[0],{30:function(e,t,n){e.exports=n(59)},53:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(26),o=n.n(i),s=n(3),l=n(4),c=n(6),u=n(5),p=n(28),m=n(1),f=n(27),d=n.n(f).a.create({baseURL:"/api/",timeout:1e4,headers:{"Content-Type":"application/json"}}),v=r.a.createContext(),h=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).options=null,a.state={gameId:null,game:null,selection:{fromPosition:null,targetPosition:null,cardName:null},selectableOptions:[]},a.mutations={startNewGame:function(){return d.post("/games").then((function(e){a.setState({gameId:e.data}),a.mutations.getGame(e.data),a.mutations.getOptions(e.data)}))},getGame:function(e){return d.get("/games/"+e).then((function(e){a.setState({game:e.data})}))},getOptions:function(e){return d.get("/games/"+e+"/options").then((function(e){a.options=e.data,a.clearSelection()}))},pickOption:function(e){return d.post("/games/"+a.state.gameId+"/options/"+e).then((function(e){a.mutations.getGame(a.state.gameId),a.mutations.getOptions(a.state.gameId)}))},onCellClick:function(e,t){e&&e.player===a.state.game.current_player?a.setOrKeepSelection(t,null,null):a.setOrKeepSelection(null,t,null)},onCardClick:function(e){a.setOrKeepSelection(null,null,e)}},a}return Object(l.a)(n,[{key:"setOrKeepSelection",value:function(e,t,n){var a={fromPosition:e||this.state.selection.fromPosition,targetPosition:t||this.state.selection.targetPosition,cardName:n||this.state.selection.cardName};this.setSelection(a)}},{key:"setSelection",value:function(e){var t=this.filterSelectionOptions(e);if(t.length>0){if(this.setState({selection:e,selectableOptions:t}),null!==e.fromPosition&&null!==e.targetPosition&&null!==e.cardName&&1===t.length){var n=this.options.indexOf(t[0]);this.mutations.pickOption(n)}}else this.clearSelection()}},{key:"clearSelection",value:function(){this.setState({selection:{fromPosition:null,targetPosition:null,cardName:null},selectableOptions:this.state.options})}},{key:"filterSelectionOptions",value:function(e){return this.options.filter((function(t){return(null===e.fromPosition||t.from_position.x===e.fromPosition.x&&t.from_position.y===e.fromPosition.y)&&((null===e.targetPosition||t.target_position.x===e.targetPosition.x&&t.target_position.y===e.targetPosition.y)&&(null===e.cardName||t.card.name===e.cardName))}))}},{key:"render",value:function(){return r.a.createElement(v.Provider,{value:{state:this.state,mutations:this.mutations}},this.props.children)}}]),n}(a.Component),g=v.Consumer,y=(n(52),n(53),function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getClasses",value:function(){var e=this.context.state.selection.fromPosition;if(e&&e.x===this.props.position.x&&e.y===this.props.position.y)return"cell from-cell";var t=this.context.state.selection.targetPosition;return t&&t.x===this.props.position.x&&t.y===this.props.position.y?"cell target-cell":"cell"}},{key:"getImageSrc",value:function(){return"/img/piece-"+(0===this.props.piece.player?"blue":"red")+"-"+(this.props.piece.is_master?"master":"apprentice")+"-front.png"}},{key:"render",value:function(){var e=this;return r.a.createElement(g,null,(function(t){t.state;var n=t.mutations;return r.a.createElement("div",{className:e.getClasses(),onClick:function(){return n.onCellClick(e.props.piece,e.props.position)}},e.props.piece&&r.a.createElement("img",{className:"piece",src:e.getImageSrc(),alt:"piece"}))}))}}]),n}(a.Component));y.contextType=v;var O=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getClasses",value:function(){var e="card";return this.context.state.selection.cardName===this.props.name&&(e+=" selected-card"),this.props.mini&&(e+=" mini-card"),e}},{key:"getImageSrc",value:function(){return"/img/card-"+this.props.name.toLowerCase()+".jpg"}},{key:"render",value:function(){var e=this;return r.a.createElement(g,null,(function(t){t.state;var n=t.mutations;return r.a.createElement("div",{className:"card-container"},r.a.createElement("img",{onClick:function(){return n.onCardClick(e.props.name)},className:e.getClasses(),src:e.getImageSrc(),alt:"card"}))}))}}]),n}(a.Component);O.contextType=v;var b=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getClasses",value:function(){return"0"===this.props.playerIndex?"player-panel":"player-panel opponent-player-panel"}},{key:"render",value:function(){var e=this;return r.a.createElement(g,null,(function(t){var n=t.state;return r.a.createElement("div",{className:e.getClasses()},parseInt(e.props.playerIndex)===n.game.current_player?r.a.createElement(O,{mini:!0,name:n.game.public_card.name}):r.a.createElement("div",{className:"mini-card"}),r.a.createElement("div",{className:"cards"},r.a.createElement(O,{name:n.game.players[e.props.playerIndex].cards[0].name}),r.a.createElement(O,{name:n.game.players[e.props.playerIndex].cards[1].name})))}))}}]),n}(a.Component);b.contextType=v;var E=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getCell",value:function(e,t){var n=5*t+e,a=this.context.state.game.field.pieces[n],i={x:e,y:t};return r.a.createElement(y,{position:i,piece:a,key:n})}},{key:"render",value:function(){var e=this;return r.a.createElement(g,null,(function(t){t.state,t.mutations;return r.a.createElement("div",{className:"field-panel"},r.a.createElement(b,{playerIndex:"1"}),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"field-rows"},[4,3,2,1,0].map((function(t){return r.a.createElement("div",{key:t,className:"field-columns"},[0,1,2,3,4].map((function(n){return e.getCell(n,t)})))})))),r.a.createElement(b,{playerIndex:"0"}))}))}}]),n}(a.Component);E.contextType=v;var j=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.color,a=e.children,i=e.disabled,o=e.style,s=e.className;return r.a.createElement(g,null,(function(e){e.state;return r.a.createElement("button",{style:o,className:s||"btn",disabled:i,color:n,onClick:t,onContextMenu:function(e){e.preventDefault(),t()}},a)}))}}]),n}(a.Component);j.contextType=v;var C=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement(g,null,(function(e){var t=e.state,n=e.mutations;return r.a.createElement("div",null,null===t.game?r.a.createElement(j,{onClick:function(){return n.startNewGame()}},"New Game"):r.a.createElement(E,null))}))}}]),n}(a.Component);C.contextType=v;var k=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement(h,{value:this.state},r.a.createElement(p.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"/",component:C,exact:!0}),r.a.createElement(m.b,null,r.a.createElement(m.a,{to:"/"}))))))}}]),n}(a.Component);o.a.render(r.a.createElement(k,null),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.07aa4667.chunk.js.map